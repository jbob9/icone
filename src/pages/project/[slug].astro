---
import { Image } from 'astro:assets';
import SectionTitle from '../../components/SectionTitle.astro';
import Button from '../../components/ui/Button.astro';
import Card from '../../components/ui/Card.astro';
import CardContent from '../../components/ui/CardContent.astro';
import CardHeader from '../../components/ui/CardHeader.astro';
import Layout from '../../layouts/Layout.astro';
import { loadQuery } from '../../sanity/lib/load-query';
import type { Project } from '../../sanity/lib/types';
import { urlForImage } from '../../sanity/lib/url-for-image';


export async function getStaticPaths() {
  const { data: projects} = await loadQuery<Project[]>({
    query: `*[_type == "project"]{
      name,
      slug,
      logo,
      mainImage,
      overview,
      tags[],
      solutions,
      challenges,
      technologies[],
      features[],
      results[],
      status,
      publishedAt,
    }`,
  });
  return projects.map((project) => ({
    params: { slug: project.slug.current },
    props: { project } 
  }));
}

const { project } = Astro.props;
---


<Layout
  title={project.name}
  description={project.overview}>
<div class="min-h-screen bg-gray-50">
    {/* Hero Section */}
    <div class="relative h-[60vh] overflow-hidden">
      <Image
        src={urlForImage(project.mainImage).format('webp').fit('fill').url()} 
        alt={project.name} 
        height={220}
        width={1120}
        class="w-full h-full object-cover"
      />
      <div class="absolute inset-0 bg-black/50 flex items-center justify-center">
        <div class="text-center text-white px-4">
          <h1 class="text-4xl md:text-6xl font-bold mb-4">{project.name}</h1>
          <p class="text-lg md:text-xl max-w-2xl mx-auto">{project.overview}</p>
        </div>
      </div>
    </div>

    <div class="container mx-auto px-4 py-16 space-y-16">
      {/* Project Overview */}
      <!-- <section>
        <SectionTitle>Project Overview</SectionTitle>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <Card>
            <CardHeader className="text-lg font-semibold">Client</CardHeader>
            <CardContent>{project.client}</CardContent>
          </Card>
          <Card>
            <CardHeader className="text-lg font-semibold">Duration</CardHeader>
            <CardContent>{project.duration}</CardContent>
          </Card>
          <Card>
            <CardHeader className="text-lg font-semibold">Year</CardHeader>
            <CardContent>{project.year}</CardContent>
          </Card>
        </div>
      </section> -->

      {/* Technologies Used */}
      <section>
        <SectionTitle>Technologies</SectionTitle>
        <div class="flex flex-wrap gap-3">
          {project.technologies?.map((tech, index) => (
            <span 
              class="px-4 py-2 bg-black text-white rounded-full text-sm"
            >
              {tech}
            </span>
          ))}
        </div>
      </section>

      {/* Challenge & Solution */}
      <section class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <Card>
          <CardHeader className="text-xl font-bold">The Challenge</CardHeader>
          <CardContent>{project.challenges}</CardContent>
        </Card>
        <Card>
          <CardHeader className="text-xl font-bold">Our Solution</CardHeader>
          <CardContent>{project.solutions}</CardContent>
        </Card>
      </section>

      <section>
        <SectionTitle>Key Features_</SectionTitle>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          {project.features?.map((feature, index) => (
            <Card>
              <CardContent className="flex items-center gap-4 p-6">
                <p class="text-lg">{feature}</p>
              </CardContent>
            </Card>
          ))}
        </div>
      </section>

      {/* Results */}
      <section>
        <SectionTitle>Key Results</SectionTitle>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          {project.results?.map((result, index) => (
            <Card>
              <CardContent className="flex items-center gap-4 p-6">
                <p class="text-lg">{result}</p>
              </CardContent>
            </Card>
          ))}
        </div>
      </section>

      {/* Gallery */}
      <section>
        <SectionTitle>Project Gallery</SectionTitle>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <!-- {project.gallery.map((image, index) => (
            <Image
              src={image}
              height={256}
              width={320}
              alt={`Project gallery ${index + 1}`}
              class="w-full h-64 object-cover rounded-lg hover:opacity-90 transition-opacity"
            />
          ))} -->
        </div>
      </section>

      {/* Call to Action */}
      <section class="text-center">
        <Button  className="mt-8">
          Start Your Project
        </Button>
      </section>
    </div>
  </div>
</Layout>